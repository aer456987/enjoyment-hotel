import ne from"./Icon.wjsf6Hii.js";import{_ as de}from"./nuxt-link.9B71KFjc.js";import{f as Q,k as m,n as ie,H as re,c as i,m as L,I as T,l as R,u as ce,q as G,o as r,a as e,b as p,w,g as o,d as O,s as $,J as me,F as z,r as M,t as d,K as S,B as C,i as H,x as J,z as K,D as ue,A as pe,p as _e,e as fe,G as be}from"./entry.5F93Vz7a.js";import{_ as he}from"./nuxt-img.BpsOkbCC.js";import{u as ve}from"./useTmpl.tD3N_OHk.js";import{T as ye}from"./TheRoomsInfo.h0V5j6TX.js";import{u as xe}from"./room.GQR_yMJG.js";import{_ as ke}from"./_plugin-vue_export-helper.x3n3nnut.js";import"./index.0wqzsba0.js";import"./vue.f36acd1f.SRfyHtNx.js";import"./ic_Size.5L4B0xdu.js";const ge=Symbol.for("nuxt:client-only"),we=Q({name:"ClientOnly",inheritAttrs:!1,props:["fallback","placeholder","placeholderTag","fallbackTag"],setup(x,{slots:u,attrs:f}){const I=m(!1);return ie(()=>{I.value=!0}),re(ge,!0),b=>{var D;if(I.value)return(D=u.default)==null?void 0:D.call(u);const h=u.fallback||u.placeholder;if(h)return h();const v=b.fallback||b.placeholder||"",c=b.fallbackTag||b.placeholderTag||"span";return i(c,f,v)}}}),n=x=>(_e("data-v-d9d2f249"),x=x(),fe(),x),Ie={class:"p-0 p-md-xl pb-md-5 bg-primary-tint"},De={class:"container-xl"},Ne={class:"row"},Ve={class:"col-md-7 mb-lg-xl"},Te=n(()=>e("h4",{class:"fw-bold mb-5"},"訂房資訊",-1)),Re={class:"pb-6 mb-6 border-bottom"},$e={class:"row align-items-center mb-4"},ze={class:"col-10"},Ce=n(()=>e("div",{class:"room-info-title-border title-border-primary ps-3 fw-bold mb-2"}," 選擇房型 ",-1)),Oe={key:0,class:"row"},Ue={class:"col-6"},Pe=["value"],qe={key:1},Me={class:"col-2"},Se={class:"row align-items-center mb-4"},je={class:"col-10"},Ae=n(()=>e("div",{class:"room-info-title-border title-border-primary ps-3 fw-bold mb-2"}," 訂房日期 ",-1)),Fe={key:0,class:"row"},Ee={class:"col-6"},Be={class:"rounded border"},Le=n(()=>e("label",{for:"",class:"d-block"},"入住 *未完成",-1)),Ge={class:"col-6"},He={class:"rounded border"},Je=n(()=>e("label",{for:"",class:"d-block"},"退房 *未完成",-1)),Ke={class:"mb-2"},Qe={class:"col-2"},We={class:"row align-items-center"},Xe={class:"col-10"},Ye=n(()=>e("div",{class:"room-info-title-border title-border-primary ps-3 fw-bold mb-2"}," 房客人數 ",-1)),Ze={key:0,class:"d-flex align-items-center"},et={class:"p-3"},tt={key:1},ot={class:"col-2"},st=n(()=>e("div",{class:"d-flex justify-content-between align-items-center mb-5"},[e("h4",{class:"fw-bold"},"訂房人資訊"),e("button",{type:"button",class:"btn btn-text text-primary fw-bold"},"套用會員資料")],-1)),lt={class:"list-unstyled pb-6 mb-6 border-bottom"},at={class:"mb-4"},nt=n(()=>e("label",{class:"form-label text-dark",for:"default"},[O(" 姓名 "),e("span",{class:"text-danger ms-1"},"*")],-1)),dt={class:"text-danger fs-8 fw-bold mt-2"},it={class:"mb-4"},rt=n(()=>e("label",{class:"form-label text-dark",for:"default"},[O(" 手機號碼 "),e("span",{class:"text-danger ms-1"},"*")],-1)),ct={class:"text-danger fs-8 fw-bold mt-2"},mt={class:"mb-4"},ut=n(()=>e("label",{class:"form-label text-dark",for:"default"},[O(" 電子信箱 "),e("span",{class:"text-danger ms-1"},"*")],-1)),pt={class:"text-danger fs-8 fw-bold mt-2"},_t=n(()=>e("li",{class:"d-md-none mb-4"},[e("label",{class:"form-label d-flex justify-content-between text-dark",for:"default"}," 生日 "),e("div",{class:"row"},[e("div",{class:"col-4 mb-3"},[e("select",{class:"form-select","aria-label":"Default select year"},[e("option",{selected:""},"選擇年分"),e("option",{value:"1990"},"1990年"),e("option",{value:"1991"},"1991年"),e("option",{value:"1992"},"1992年")])]),e("div",{class:"col-4"},[e("select",{class:"form-select","aria-label":"Default select month"},[e("option",{selected:""},"請選擇月份"),e("option",{value:"1"},"1月"),e("option",{value:"2"},"2月"),e("option",{value:"3"},"3月")])]),e("div",{class:"col-4"},[e("select",{class:"form-select","aria-label":"Default select day"},[e("option",{selected:""},"請選擇日期"),e("option",{value:"1"},"1日"),e("option",{value:"2"},"2日"),e("option",{value:"3"},"3日")])])])],-1)),ft=n(()=>e("label",{class:"form-label d-flex justify-content-between text-dark",for:"default"}," 地址 ",-1)),bt={class:"row"},ht={class:"col-6 mb-3"},vt=n(()=>e("option",{value:"",selected:""},"請選擇縣市",-1)),yt=["value"],xt={class:"col-6"},kt=n(()=>e("option",{value:"",selected:""},"請選擇區域",-1)),gt=["value"],wt={class:"col-12"},It={class:"col-md-5 mb-5 mb-lg-0"},Dt={class:"bg-light rounded-4 p-4 p-lg-5"},Nt={class:"rounded-3 overflow-hidden"},Vt=n(()=>e("h3",{class:"fs-6 fs-md-4 fw-bold my-4 mt-lg-5"},"價格詳情",-1)),Tt={class:"list-unstyled mb-4 mb-lg-5"},Rt={class:"d-flex justify-content-between active mb-3"},$t={class:"text-gray-80"},zt={key:0,class:"d-flex justify-content-between active mb-4 pb-4 border-bottom"},Ct=n(()=>e("span",null,"住宿折扣",-1)),Ot={class:"text-primary"},Ut={class:"d-flex justify-content-between active fw-bold"},Pt=n(()=>e("span",null,"總價",-1)),qt={key:0,class:"text-danger text-center fw-bold"},Mt=["disabled"],St={class:"modal-dialog modal-dialog-centered modal-lg"},jt={class:"modal-content p-xl"},At={class:"modal-body d-flex flex-column justify-content-center align-items-center"},Ft=n(()=>e("div",{class:"d-flex"},[e("span",{class:"spinner-grow spinner-grow-sm mb-xl text-primary-dark me-2",role:"status"}),e("span",{class:"spinner-grow spinner-grow-sm mb-xl text-primary-dark me-2"}),e("span",{class:"spinner-grow spinner-grow-sm mb-xl text-primary-dark"})],-1)),Et=n(()=>e("div",{class:"fs-5 fw-bold"},"正在處理你的預訂",-1)),Bt=Q({__name:"reserve",async setup(x){let u,f;const{getRoomsApi:I,submitOrderApi:b}=J();let h=[];[u,f]=L(()=>I({onResponse({response:a}){a._data.status&&(h=a._data.result.map(t=>({id:t._id,name:t.name,imageUrl:t.imageUrl,price:t.price,discountPrice:1950,roomDetail:{amenityInfo:t.amenityInfo,facilityInfo:t.facilityInfo,areaInfo:t.areaInfo,bedInfo:t.bedInfo,maxPeople:t.maxPeople}})))},onResponseError({error:a}){console.log("error: ",a)}})),await u,f();const v=xe();let c=T(v.defaultRoomInfo);const D=m(null),W=R(()=>`${_.city}${_.district.district}${_.street}`),X=ce(),l=T({roomId:X.query.id||"",checkInDate:m(v.checkInDate),checkOutDate:m(v.checkOutDate),peopleNum:m(v.peopleNum),userInfo:{address:{zipcode:m(""),detail:m(W)},name:m(""),phone:m(""),email:m("")}});G(()=>l.roomId,a=>{a||K("/rooms"),c=h.filter(t=>t.id===a)[0]},{immediate:!0});const{cityTmpl:Y}=ve();let U=T([]);const _=T({city:"台北市",street:"",district:{district:"",zipcode:""}}),{getTwzipcodeApi:Z}=J(),{pending:Lt,refresh:ee}=([u,f]=L(()=>Z({query:R(()=>({city:_.city})),immediate:!1,onResponse({response:a}){if(!a._data.status)return;const t=a._data.data.map(V=>({zipcode:V.zip_code,district:V.district}));U=t,_.district=t[0],l.userInfo.address.zipcode=_.district.zipcode}})),u=await u,f(),u);ee(),G(()=>l.userInfo.address.zipcode,a=>{_.district=U.filter(t=>t.zipcode===a)[0]});const{$dayjs:j}=be();function A(a){return j(a).format("M 月 D 日 dddd")}const P=R(()=>j(l.checkInDate).diff(l.checkOutDate,"day")*-1),k={roomType:m(!1),checkDate:m(!1),peopleNum:m(!1)};function q(a){k[a].value=!k[a].value}function F(a){const t=c.roomDetail.maxPeople;switch(a){case"increase":if(t===l.peopleNum)return;l.peopleNum=t>l.peopleNum?l.peopleNum+=1:t;break;case"decrease":if(l.peopleNum===1)return;l.peopleNum=t<=l.peopleNum?l.peopleNum-=1:1;break}}let N="";async function te(){console.log("submitOrder"),await b({body:R(()=>l),onResponse({response:a}){if(!a._data.status){N=a._data.message;return}N="";const t=a._data.result._id;K({path:"/confirmation",query:{id:t}})},onResponseError({error:a}){console.log("error: ",a)}})}return(a,t)=>{const V=ne,oe=de,g=ue,E=he,se=pe,le=we;return r(),i("div",Ie,[e("div",De,[p(oe,{to:`/room/${o(l).roomId}`,class:"btn btn-ghost d-flex align-items-center py-5 text-dark p-0 fs-3 fw-bold"},{default:w(()=>[p(V,{class:"fs-1 fw-bold",name:"ic:round-keyboard-arrow-left"}),O(" 確認訂房資訊 ")]),_:1},8,["to"]),p(le,null,{default:w(()=>[p(se,{ref_key:"formRefs",ref:D,onSubmit:te},{default:w(({meta:ae,errors:y,isSubmitting:B})=>[e("div",Ne,[e("div",Ve,[Te,e("div",Re,[e("div",$e,[e("div",ze,[Ce,k.roomType.value?(r(),i("div",Oe,[e("div",Ue,[$(e("select",{class:"form-select","onUpdate:modelValue":t[0]||(t[0]=s=>o(l).roomId=s)},[(r(!0),i(z,null,M(o(h),s=>(r(),i("option",{key:s.id,value:s.id},d(s.name),9,Pe))),128))],512),[[me,o(l).roomId]])])])):(r(),i("div",qe,d(o(c).name),1))]),e("div",Me,[e("button",{type:"button",class:"btn btn-text text-dark fw-bold",onClick:t[1]||(t[1]=s=>q("roomType"))}," 編輯 ")])]),e("div",Se,[e("div",je,[Ae,k.checkDate.value?(r(),i("div",Fe,[e("div",Ee,[e("div",Be,[Le,$(e("input",{type:"date",class:"form","onUpdate:modelValue":t[2]||(t[2]=s=>o(l).checkInDate=s)},null,512),[[S,o(l).checkInDate]])])]),e("div",Ge,[e("div",He,[Je,$(e("input",{type:"date",class:"form","onUpdate:modelValue":t[3]||(t[3]=s=>o(l).checkOutDate=s)},null,512),[[S,o(l).checkOutDate]])])])])):(r(),i(z,{key:1},[e("div",Ke," 入住："+d(A(o(l).checkInDate)),1),e("div",null," 退房："+d(A(o(l).checkOutDate)),1)],64))]),e("div",Qe,[e("button",{type:"button",class:"btn btn-text text-dark fw-bold",onClick:t[4]||(t[4]=s=>q("checkDate"))}," 編輯 ")])]),e("div",We,[e("div",Xe,[Ye,k.peopleNum.value?(r(),i("div",Ze,[e("button",{type:"button",class:"btn btn btn-outline-primary text-dark py-2 px-3",onClick:t[5]||(t[5]=s=>F("decrease"))}," － "),e("span",et,d(o(l).peopleNum),1),e("button",{type:"button",class:"btn btn btn-outline-primary text-dark py-2 px-3",onClick:t[6]||(t[6]=s=>F("increase"))}," ＋ ")])):(r(),i("div",tt,d(o(l).peopleNum)+" 人",1))]),e("div",ot,[e("button",{type:"button",class:"btn btn-text text-dark fw-bold",onClick:t[7]||(t[7]=s=>q("peopleNum"))}," 編輯 ")])])]),st,e("ul",lt,[e("li",at,[nt,p(g,{id:"name",modelValue:o(l).userInfo.name,"onUpdate:modelValue":t[8]||(t[8]=s=>o(l).userInfo.name=s),modelModifiers:{trim:!0},class:C([y.name&&"verify-error","form-control"]),name:"name",label:"姓名",type:"name",placeholder:"請輸入姓名",rules:"required"},null,8,["modelValue","class"]),e("div",dt,d(y.name),1)]),e("li",it,[rt,p(g,{id:"phone",modelValue:o(l).userInfo.phone,"onUpdate:modelValue":t[9]||(t[9]=s=>o(l).userInfo.phone=s),modelModifiers:{trim:!0},class:C([y.phone&&"verify-error","form-control"]),name:"phone",label:"手機號碼",type:"phone",placeholder:"請輸入手機號碼",rules:"required"},null,8,["modelValue","class"]),e("div",ct,d(y.phone),1)]),e("li",mt,[ut,p(g,{id:"email",modelValue:o(l).userInfo.email,"onUpdate:modelValue":t[10]||(t[10]=s=>o(l).userInfo.email=s),modelModifiers:{trim:!0},class:C([y.email&&"verify-error","form-control"]),name:"email",label:"電子信箱",type:"email",placeholder:"請輸入電子信箱",rules:"required|email"},null,8,["modelValue","class"]),e("div",pt,d(y.email),1)]),_t,e("li",null,[ft,e("div",bt,[e("div",ht,[p(g,{modelValue:o(_).city,"onUpdate:modelValue":t[11]||(t[11]=s=>o(_).city=s),class:"form-select",name:"city",as:"select",rules:"required"},{default:w(()=>[vt,(r(!0),i(z,null,M(o(Y),s=>(r(),i("option",{key:s,value:s},d(s),9,yt))),128))]),_:1},8,["modelValue"])]),e("div",xt,[p(g,{modelValue:o(l).userInfo.address.zipcode,"onUpdate:modelValue":t[12]||(t[12]=s=>o(l).userInfo.address.zipcode=s),class:"form-select",name:"district",as:"select",rules:"required"},{default:w(()=>[kt,(r(!0),i(z,null,M(o(U),s=>(r(),i("option",{key:`${s.district}_${s.zipcode}`,value:s.zipcode},d(s.district),9,gt))),128))]),_:1},8,["modelValue"])]),e("div",wt,[$(e("input",{id:"text",class:"form-control",type:"default",placeholder:"請輸入詳細地址","onUpdate:modelValue":t[13]||(t[13]=s=>o(_).street=s)},null,512),[[S,o(_).street]])])])])]),p(ye,{"room-detail":o(c).roomDetail,"mb-space":"4"},null,8,["room-detail"])]),e("div",It,[e("div",Dt,[e("div",Nt,[p(E,{class:"w-100 h-auto",src:o(c).imageUrl,alt:"Room_1"},null,8,["src"])]),Vt,e("ul",Tt,[e("li",Rt,[e("div",null,[e("span",null,"NT$ "+d(o(c).price)+" ×",1),e("span",$t,d(o(P)),1)]),e("span",null,"NT$ "+d(o(c).price*o(P)),1)]),o(c).discountPrice?(r(),i("li",zt,[Ct,e("span",Ot,"-NT$ "+d(o(c).discountPrice||0),1)])):H("",!0),e("li",Ut,[Pt,e("span",null,"NT$ "+d(o(c).price*o(P)-o(c).discountPrice),1)])]),o(N).length>0?(r(),i("div",qt,d(o(N)),1)):H("",!0),e("button",{type:"submit",class:"btn btn-primary w-100",disabled:!ae.valid||B}," 確認訂房 ",8,Mt)])])]),e("div",{id:"orderLoadModal",class:C(["modal fade",`modal fade ${B?"show d-block":""}`]),tabindex:"-1"},[e("div",St,[e("div",jt,[e("div",At,[Ft,p(E,{class:"w-80 mb-3",src:"/img/logo-primary.svg"}),Et])])])],2)]),_:1},512)]),_:1})])])}}}),oo=ke(Bt,[["__scopeId","data-v-d9d2f249"]]);export{oo as default};
