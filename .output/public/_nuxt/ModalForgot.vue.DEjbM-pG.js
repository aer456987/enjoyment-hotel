import{f as U,k as u,n as $,l as f,m as w,o as S,E as D,b as c,w as E,T as I,G as T,A as z,a as e,g as l,B as p,t as _,x as G,D as j}from"./entry.5F93Vz7a.js";const H={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable"},J={class:"modal-content"},K=e("div",{class:"modal-header"},[e("h5",{id:"exampleModalLabel",class:"modal-title"},"忘記密碼"),e("button",{class:"btn-close",type:"button","aria-label":"Close","data-bs-dismiss":"modal"})],-1),O={class:"modal-body"},Q=e("label",{class:"form-label text-dark",for:"ModalForgotEmail"},"註冊電子信箱",-1),W={class:"text-danger fs-8 fw-bold mt-2"},X={class:"modal-footer"},Y=["disabled"],Z=["disabled"],ee={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable"},ae={class:"modal-content"},le=e("div",{class:"modal-header"},[e("h5",{id:"exampleModalLabel",class:"modal-title"},"重設密碼"),e("button",{class:"btn-close",type:"button","aria-label":"Close","data-bs-dismiss":"modal"})],-1),se={class:"modal-body"},oe=e("label",{class:"form-label text-dark",for:"ModalForgot2Email"},"註冊電子信箱",-1),de={class:"text-danger fs-8 fw-bold mt-2"},te=e("label",{class:"form-label text-dark",for:"ModalForgot2Code"},"Node 驗證碼",-1),ie={class:"text-danger fs-8 fw-bold mt-2"},ne=e("label",{class:"form-label text-dark",for:"ModalForgot2NewPassword"},"新密碼",-1),re={class:"text-danger fs-8 fw-bold mt-2"},me={class:"modal-footer"},ce=["disabled"],be=["disabled"],pe=U({__name:"ModalForgot",async setup(ue){let o,m;const h=u(null),b=u({email:""}),g=u(null),i=u({email:"",code:"",newPassword:""}),y=s=>{s===0?A():L()},{$swal:x,$bootstrap:M}=T();let F,v;$(()=>{const s=document.getElementById("ModalForgot"),a=document.getElementById("ModalForgot2");F=M.modal(s),v=M.modal(a),s==null||s.addEventListener("hidden.bs.modal",()=>{var t;(t=h.value)==null||t.resetForm({email:""})}),a==null||a.addEventListener("hidden.bs.modal",()=>{var t;(t=g.value)==null||t.resetForm({email:"",code:"",newPassword:""})})});const{checkEmailApi:R,sendEmailCodeApi:C,resetPasswordApi:N}=G(),n=f(()=>V.value||P.value),{pending:V,refresh:A}=([o,m]=w(()=>R({body:f(()=>b.value),immediate:!1,watch:!1,onResponse({response:s}){var a;s.status===200&&(s._data.result.isEmailExists?B():(a=h.value)==null||a.setFieldError("email","使用者不存在"))}})),o=await o,m(),o);V.value=!1;const{pending:P,refresh:B}=([o,m]=w(()=>C({body:f(()=>b.value),immediate:!1,watch:!1,onResponse({response:s}){s.status===200&&x.fire({icon:"success",title:"驗證碼發送成功"}).then(()=>{i.value.email=b.value.email,F.hide(),v.show()})}})),o=await o,m(),o);P.value=!1;const{pending:q,refresh:L}=([o,m]=w(()=>N({body:f(()=>i.value),immediate:!1,watch:!1,onResponse({response:s}){s.status===200&&s._data.status&&(x.fire({icon:"success",title:"密碼重設成功"}),v.hide())}})),o=await o,m(),o);return q.value=!1,(s,a)=>{const t=j,k=z;return S(),D(I,{to:"body"},[c(k,{id:"ModalForgot",ref_key:"formRefs",ref:h,class:"modal fade","aria-hidden":"true","aria-labelledby":"exampleModalLabel","data-bs-backdrop":"static",tabindex:"-1",onSubmit:a[1]||(a[1]=d=>y(0))},{default:E(({errors:d})=>[e("div",H,[e("div",J,[K,e("div",O,[Q,c(t,{id:"ModalForgotEmail",modelValue:l(b).email,"onUpdate:modelValue":a[0]||(a[0]=r=>l(b).email=r),modelModifiers:{trim:!0},class:p([d.email&&"verify-error","form-control"]),name:"email",label:"註冊電子信箱",type:"email",placeholder:"hello@exsample.com",rules:"required|email",disabled:l(n)},null,8,["modelValue","class","disabled"]),e("div",W,_(d.email),1)]),e("div",X,[e("button",{class:"btn btn-outline-primary",type:"submit","data-bs-dismiss":"modal",disabled:l(n)}," 取消 ",8,Y),e("button",{class:"btn btn-primary",type:"submit",disabled:l(n)},"驗證",8,Z)])])])]),_:1},512),c(k,{id:"ModalForgot2",ref_key:"form2Refs",ref:g,class:"modal fade","aria-hidden":"true","aria-labelledby":"exampleModalLabel","data-bs-backdrop":"static",tabindex:"-1",onSubmit:a[5]||(a[5]=d=>y(1))},{default:E(({errors:d})=>[e("div",ee,[e("div",ae,[le,e("div",se,[e("div",null,[oe,c(t,{id:"ModalForgot2Email",modelValue:l(i).email,"onUpdate:modelValue":a[2]||(a[2]=r=>l(i).email=r),modelModifiers:{trim:!0},class:p([d.email&&"verify-error","form-control"]),name:"email",label:"註冊電子信箱",type:"email",placeholder:"hello@exsample.com",rules:"required|email",disabled:l(n)},null,8,["modelValue","class","disabled"]),e("div",de,_(d.email),1)]),e("div",null,[te,c(t,{id:"ModalForgot2Code",modelValue:l(i).code,"onUpdate:modelValue":a[3]||(a[3]=r=>l(i).code=r),modelModifiers:{trim:!0},class:p([d.code&&"verify-error","form-control"]),name:"code",label:"Node 驗證碼",type:"text",placeholder:"Node 驗證碼",rules:"required",disabled:l(n)},null,8,["modelValue","class","disabled"]),e("div",ie,_(d.code),1)]),e("div",null,[ne,c(t,{id:"ModalForgot2NewPassword",modelValue:l(i).newPassword,"onUpdate:modelValue":a[4]||(a[4]=r=>l(i).newPassword=r),modelModifiers:{trim:!0},class:p([d.newPassword&&"verify-error","form-control"]),name:"newPassword",label:"新密碼",type:"password",placeholder:"請輸入新密碼",rules:"required",disabled:l(n)},null,8,["modelValue","class","disabled"]),e("div",re,_(d.newPassword),1)])]),e("div",me,[e("button",{class:"btn btn-outline-primary",type:"submit","data-bs-dismiss":"modal",disabled:l(n)}," 取消 ",8,ce),e("button",{class:"btn btn-primary",type:"submit",disabled:l(n)},"確認",8,be)])])])]),_:1},512)])}}});export{pe as _};
